<!-- app/views/posts/edit.html.erb -->

<div class="cover-edit">
  <div class="container">

    <h1 class="page-title text-center mt-5 mb-4">
      記録を続ける
    </h1>

    <div class="row justify-content-center">
      <div class="col-md-8">

        <%= form_with model: @post, local: true, html: { multipart: true } do |f| %>

          <div class="mb-3">
            <%= f.text_area :content,
                  rows: 5,
                  class: "form-control",
                  placeholder: "続きを書いてみましょう。" %>
          </div>

          <div class="mb-3 border-top pt-3">
            <label class="form-label text-muted small">
              写真を添える（任意）
            </label>

            <% if @post.image.attached? %>
              <div class="mb-2">
                <%= image_tag @post.image.variant(resize_to_limit: [450, 350]),
                      class: "img-fluid rounded" %>
              </div>
            <% end %>

            <%= f.file_field :image,
                  class: "form-control form-control-sm" %>
          </div>

          <!-- status 切り替え -->
          <%= f.hidden_field :status,
                value: @post.status,
                id: "post_status" %>

          <div class="text-center mt-4">
            <%= f.submit "公開する",
                  class: "btn btn-primary px-4 me-2",
                  onclick: "document.getElementById('post_status').value='published'" %>

            <%= f.submit "下書きのまま保存",
                  class: "btn btn-outline-secondary px-4",
                  onclick: "document.getElementById('post_status').value='draft'" %>
          </div>

        <% end %>

        <div class="text-center mt-4">
          <%= link_to "一覧へ戻る",
                posts_path,
                class: "btn btn-link text-muted" %>
        </div>

      </div>
    </div>

  </div>
</div>
