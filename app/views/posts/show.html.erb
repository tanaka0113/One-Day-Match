<div class="cover-show">
  <div class="container">

    <div class="row">
    <h1 class="font-weight-normal mt-5 mb-2 text-center">
    今日の記録
  </h1>
  
      <p class="text-center text-muted mb-5">
        <%= @post.created_at.strftime("%Y年%m月%d日") %>
      </p>
    </div>

    <div class="d-block text-center">

      <p class="caption mb-3">
        今日、誰かと話したかった人
      </p>
      <p class="text-muted mb-4">
      <%= @post.user&.name || "匿名ユーザー" %>
    </p>
    
      <% if @post.image.attached? %>
        <%= image_tag @post.image.variant(resize_to_limit: [450, 350]) %><br>
      <% end %>

      <h2 class="mt-4 mb-2">
        今日のひとこと
      </h2>

      <p id="text" class="mb-4">
      <%= simple_format(@post.content) %>
      </p>

      <% if @post.user == current_user %>
        <div class="mt-4">
          <%= link_to "書き直す",
                edit_post_path(@post),
                class: "btn btn-outline-secondary me-2" %>

          <%= link_to "この記録を削除する",
                post_path(@post),
                data: { turbo_method: :delete, turbo_confirm: "この日の記録を削除しますか？" },
                class: "btn btn-outline-danger" %>
        </div>
      <% end %>

      <div class="mt-5">
        <%= link_to "今日の投稿一覧へ戻る",
              posts_path,
              class: "btn btn-dark" %>
      </div>

    </div>
  </div>
</div>

<hr class="my-5">

<h2 class="text-center mb-4">
  この日に交わされた言葉
</h2>

<p class="text-center text-muted mb-4">
  💬 <%= @comments.count %> 件のやりとり
</p>

<% @comments.each do |comment| %>
<div class="comments-index mb-3 p-3 border rounded bg-white">




<div class="d-flex justify-content-between align-items-center mb-1">
<span class="text-muted small">
<%= comment.user&.name || "匿名ユーザー" %>
</span>
<span class="text-muted small">
  <%= comment.created_at.strftime("%m/%d") %>
</span>
</div>

    <div class="d-flex">
    <p class="mb-0">
    <%= comment.content %>
  </p>
  

      <% if comment.user == current_user %>
  <%= link_to "この言葉を消す",
        post_comment_path(@post, comment),
        data: { turbo_method: :delete, turbo_confirm: "この言葉を消しますか？" },
        class: "btn btn-sm btn-link text-muted ms-auto" %>
<% end %>

    </div>

  </div>
<% end %>


<hr class="my-5">

<h3 class="text-center mb-3">
  今日のあなたへ返す
</h3>

<%= form_with(model: [@post, @comment], local: true) do |f| %>
  <div class="mb-3">
    <%= f.text_area :content,
          rows: 3,
          placeholder: "ひとこと返す",
          class: "form-control" %>
  </div>

  <div class="text-center">
    <%= f.submit "送信する",
          class: "btn btn-success px-4" %>
  </div>
<% end %>
