<div class="post-show-bg">
  <div class="container mt-5">

    <div class="row">

      <!-- Â∑¶ÔºöÊäïÁ®øÂÜÖÂÆπ -->
      <div class="col-md-7">

        <h1 class="text-center mb-2">
          ÊäïÁ®øÂÜÖÂÆπ
        </h1>

        <p class="text-center text-muted mb-4">
          <%= @post.created_at.strftime("%YÂπ¥%mÊúà%dÊó•") %>
        </p>

        <p class="text-center small text-muted mb-3">
          ‰Ωï„Åß„ÇÇËá™Áî±„Å´ÊäïÁ®ø„Åó„Çà„ÅÜ
        </p>

        <p class="text-center mb-4">
          <%= @post.user&.name || "ÂåøÂêç„É¶„Éº„Ç∂„Éº" %>
        </p>

        <% if @post.image.attached? %>
          <%= image_tag @post.image, class: "img-fluid mb-4" %>
        <% end %>

        <h2 class="mt-4 mb-2">
          ‰ªäÊó•„ÅÇ„Å£„ÅüÂá∫Êù•‰∫ã
        </h2>

        <div class="mt-2">
          <% if user_signed_in? %>
            <% if @post.likes.exists?(user: current_user) %>
              <%= button_to post_like_path(@post, @post.likes.find_by(user: current_user)),
                    method: :delete,
                    class: "btn btn-link p-0 text-danger" do %>
                ‚ù§Ô∏è <%= @post.likes.count %> „ÅÑ„ÅÑ„Å≠
              <% end %>
            <% else %>
              <%= button_to post_likes_path(@post),
                    method: :post,
                    class: "btn btn-link p-0 text-muted" do %>
                ü§ç <%= @post.likes.count %> „ÅÑ„ÅÑ„Å≠
              <% end %>
            <% end %>
          <% else %>
            <span class="text-muted small">
              ‚ù§Ô∏è <%= @post.likes.count %> „ÅÑ„ÅÑ„Å≠
            </span>
          <% end %>
        </div>

        <p class="mb-4">
          <%= simple_format(@post.content) %>
        </p>

        <% if @post.user == current_user %>
  <div class="mt-4">
    <%= link_to "Êõ∏„ÅçÁõ¥„Åô",
          edit_post_path(@post),
          class: "btn btn-outline-secondary me-2" %>

    <%= button_to "„Åì„ÅÆË®òÈå≤„ÇíÂâäÈô§„Åô„Çã",
          post_path(@post),
          method: :delete,
          data: { turbo_confirm: "„Åì„ÅÆÊó•„ÅÆË®òÈå≤„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü" },
          class: "btn btn-outline-danger d-inline" %>
  </div>
<% end %>


      </div>

      <!-- Âè≥Ôºö„Ç≥„É°„É≥„Éà -->
      <div class="col-md-5">

        <h3 class="mb-2">
          „Ç≥„É°„É≥„Éà‰∏ÄË¶ß
        </h3>

        <p class="text-muted mb-3">
          üí¨ <%= @comments.count %> ‰ª∂„ÅÆ„ÇÑ„Çä„Å®„Çä
        </p>

        <% @comments.each do |comment| %>
          <div class="mb-3 p-3 border rounded bg-white">
            <div class="d-flex justify-content-between mb-1">
              <span class="small text-muted">
                <%= comment.user&.name || "ÂåøÂêç„É¶„Éº„Ç∂„Éº" %>
              </span>
              <span class="small text-muted">
                <%= comment.created_at.strftime("%m/%d") %>
              </span>
            </div>

            <p class="mb-1">
              <%= comment.content %>
            </p>

            <% if comment.user == current_user %>
              <%= link_to "„Åì„ÅÆË®ÄËëâ„ÇíÊ∂à„Åô",
                    post_comment_path(@post, comment),
                    data: { turbo_method: :delete, turbo_confirm: "„Åì„ÅÆË®ÄËëâ„ÇíÊ∂à„Åó„Åæ„Åô„ÅãÔºü" },
                    class: "btn btn-sm btn-link text-muted p-0" %>
            <% end %>
          </div>
        <% end %>

        <hr>

        <h4 class="mb-2">
          „Ç≥„É°„É≥„Éà
        </h4>

        <%= form_with(model: [@post, @comment], local: true) do |f| %>
          <%= f.text_area :content,
                rows: 3,
                placeholder: "„Å≤„Å®„Åì„Å®Ëøî„Åô",
                class: "form-control mb-2" %>

          <%= f.submit "ÈÄÅ‰ø°„Åô„Çã",
                class: "btn btn-success btn-sm" %>
        <% end %>

      </div>
    </div>

    <div class="text-center mt-5">
      <%= link_to "‚Üê ‰ªäÊó•„ÅÆÊäïÁ®ø‰∏ÄË¶ß„Å∏Êàª„Çã",
            posts_path,
            class: "btn btn-outline-secondary btn-sm" %>
    </div>

  </div>
</div>
